function cov_l7mg58j6d(){var path="/Users/lisboa/Downloads/commercetools-api-load-testing/data-generation/src/customers/importer.js";var hash="e36a779e969f0d28cbe292981b58774bc57330ae";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/lisboa/Downloads/commercetools-api-load-testing/data-generation/src/customers/importer.js",statementMap:{"0":{start:{line:1,column:20},end:{line:1,column:46}},"1":{start:{line:2,column:33},end:{line:2,column:60}},"2":{start:{line:3,column:20},end:{line:3,column:40}},"3":{start:{line:4,column:15},end:{line:4,column:47}},"4":{start:{line:5,column:27},end:{line:5,column:50}},"5":{start:{line:6,column:31},end:{line:6,column:57}},"6":{start:{line:7,column:23},end:{line:7,column:43}},"7":{start:{line:8,column:15},end:{line:8,column:39}},"8":{start:{line:10,column:20},end:{line:14,column:1}},"9":{start:{line:11,column:2},end:{line:13,column:3}},"10":{start:{line:17,column:20},end:{line:17,column:30}},"11":{start:{line:19,column:17},end:{line:19,column:45}},"12":{start:{line:20,column:27},end:{line:20,column:57}},"13":{start:{line:21,column:2},end:{line:21,column:52}},"14":{start:{line:21,column:29},end:{line:21,column:52}},"15":{start:{line:23,column:2},end:{line:23,column:68}},"16":{start:{line:24,column:16},end:{line:26,column:3}},"17":{start:{line:28,column:21},end:{line:28,column:27}},"18":{start:{line:29,column:2},end:{line:29,column:30}},"19":{start:{line:31,column:24},end:{line:31,column:52}},"20":{start:{line:32,column:14},end:{line:32,column:16}},"21":{start:{line:33,column:2},end:{line:40,column:3}},"22":{start:{line:33,column:21},end:{line:33,column:22}},"23":{start:{line:34,column:19},end:{line:34,column:47}},"24":{start:{line:35,column:4},end:{line:35,column:58}},"25":{start:{line:36,column:4},end:{line:39,column:5}},"26":{start:{line:37,column:6},end:{line:37,column:38}},"27":{start:{line:38,column:6},end:{line:38,column:16}},"28":{start:{line:41,column:2},end:{line:41,column:34}},"29":{start:{line:42,column:2},end:{line:42,column:60}},"30":{start:{line:44,column:2},end:{line:44,column:59}},"31":{start:{line:45,column:18},end:{line:45,column:28}},"32":{start:{line:46,column:2},end:{line:48,column:3}},"33":{start:{line:50,column:2},end:{line:50,column:14}},"34":{start:{line:54,column:2},end:{line:60,column:3}},"35":{start:{line:56,column:6},end:{line:56,column:60}},"36":{start:{line:57,column:6},end:{line:57,column:21}},"37":{start:{line:58,column:6},end:{line:58,column:29}},"38":{start:{line:63,column:17},end:{line:63,column:18}},"39":{start:{line:69,column:2},end:{line:85,column:3}},"40":{start:{line:70,column:26},end:{line:70,column:65}},"41":{start:{line:71,column:4},end:{line:71,column:71}},"42":{start:{line:73,column:4},end:{line:73,column:21}},"43":{start:{line:74,column:4},end:{line:82,column:5}},"44":{start:{line:80,column:6},end:{line:80,column:76}},"45":{start:{line:81,column:6},end:{line:81,column:12}},"46":{start:{line:84,column:4},end:{line:84,column:13}},"47":{start:{line:89,column:17},end:{line:89,column:44}},"48":{start:{line:90,column:2},end:{line:90,column:56}},"49":{start:{line:91,column:2},end:{line:91,column:17}},"50":{start:{line:92,column:2},end:{line:92,column:25}},"51":{start:{line:96,column:20},end:{line:101,column:3}},"52":{start:{line:105,column:6},end:{line:105,column:62}},"53":{start:{line:107,column:24},end:{line:107,column:25}},"54":{start:{line:108,column:2},end:{line:111,column:3}},"55":{start:{line:109,column:20},end:{line:109,column:30}},"56":{start:{line:110,column:4},end:{line:110,column:64}},"57":{start:{line:112,column:2},end:{line:112,column:24}},"58":{start:{line:115,column:0},end:{line:117,column:1}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:36},end:{line:10,column:37}},loc:{start:{line:11,column:2},end:{line:13,column:3}},line:11},"1":{name:"generateCustomers",decl:{start:{line:16,column:15},end:{line:16,column:32}},loc:{start:{line:16,column:50},end:{line:51,column:1}},line:16},"2":{name:"executeBatch",decl:{start:{line:53,column:15},end:{line:53,column:27}},loc:{start:{line:53,column:42},end:{line:61,column:1}},line:53},"3":{name:"(anonymous_3)",decl:{start:{line:55,column:14},end:{line:55,column:15}},loc:{start:{line:55,column:49},end:{line:59,column:5}},line:55},"4":{name:"buildDraftAndCreateCustomer",decl:{start:{line:64,column:15},end:{line:64,column:42}},loc:{start:{line:68,column:2},end:{line:86,column:1}},line:68},"5":{name:"createLastCustomer",decl:{start:{line:88,column:15},end:{line:88,column:33}},loc:{start:{line:88,column:62},end:{line:93,column:1}},line:88},"6":{name:"fetchLastCustomerKey",decl:{start:{line:95,column:15},end:{line:95,column:35}},loc:{start:{line:95,column:38},end:{line:113,column:1}},line:95}},branchMap:{"0":{loc:{start:{line:16,column:33},end:{line:16,column:48}},type:"default-arg",locations:[{start:{line:16,column:45},end:{line:16,column:48}}],line:16},"1":{loc:{start:{line:21,column:2},end:{line:21,column:52}},type:"if",locations:[{start:{line:21,column:2},end:{line:21,column:52}},{start:{line:21,column:2},end:{line:21,column:52}}],line:21},"2":{loc:{start:{line:36,column:4},end:{line:39,column:5}},type:"if",locations:[{start:{line:36,column:4},end:{line:39,column:5}},{start:{line:36,column:4},end:{line:39,column:5}}],line:36},"3":{loc:{start:{line:67,column:2},end:{line:67,column:18}},type:"default-arg",locations:[{start:{line:67,column:17},end:{line:67,column:18}}],line:67},"4":{loc:{start:{line:74,column:4},end:{line:82,column:5}},type:"if",locations:[{start:{line:74,column:4},end:{line:82,column:5}},{start:{line:74,column:4},end:{line:82,column:5}}],line:74},"5":{loc:{start:{line:75,column:6},end:{line:78,column:30}},type:"binary-expr",locations:[{start:{line:75,column:6},end:{line:75,column:29}},{start:{line:76,column:7},end:{line:76,column:29}},{start:{line:77,column:8},end:{line:77,column:30}},{start:{line:78,column:8},end:{line:78,column:29}}],line:75},"6":{loc:{start:{line:108,column:2},end:{line:111,column:3}},type:"if",locations:[{start:{line:108,column:2},end:{line:111,column:3}},{start:{line:108,column:2},end:{line:111,column:3}}],line:108},"7":{loc:{start:{line:108,column:6},end:{line:108,column:46}},type:"binary-expr",locations:[{start:{line:108,column:6},end:{line:108,column:24}},{start:{line:108,column:28},end:{line:108,column:46}}],line:108}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0],"1":[0,0],"2":[0,0],"3":[0],"4":[0,0],"5":[0,0,0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e36a779e969f0d28cbe292981b58774bc57330ae"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_l7mg58j6d=function(){return actualCoverage;};}return actualCoverage;}cov_l7mg58j6d();const ProgressLog=(cov_l7mg58j6d().s[0]++,require('../progress-log'));const{fetchCustomersConfig}=(cov_l7mg58j6d().s[1]++,require('../custom-object'));const{apiRoot}=(cov_l7mg58j6d().s[2]++,require('../client'));const logger=(cov_l7mg58j6d().s[3]++,require('../logger').getLogger());const{validateConfig}=(cov_l7mg58j6d().s[4]++,require('../validator'));const{buildCustomerDraft}=(cov_l7mg58j6d().s[5]++,require('./draft-builder'));const{randomWord}=(cov_l7mg58j6d().s[6]++,require('../random'));const schema=(cov_l7mg58j6d().s[7]++,require('./schema.json'));const progressLog=(cov_l7mg58j6d().s[8]++,new ProgressLog((progress,processed,total)=>{cov_l7mg58j6d().f[0]++;cov_l7mg58j6d().s[9]++;return logger.info(`Progress on customer data generation: ${progress}% (${processed}/${total}).`);}));async function generateCustomers(batchSize=(cov_l7mg58j6d().b[0][0]++,100)){cov_l7mg58j6d().f[1]++;const startDate=(cov_l7mg58j6d().s[10]++,new Date());const config=(cov_l7mg58j6d().s[11]++,await fetchCustomersConfig());const validationResult=(cov_l7mg58j6d().s[12]++,validateConfig(schema,config));cov_l7mg58j6d().s[13]++;if(validationResult.skip){cov_l7mg58j6d().b[1][0]++;cov_l7mg58j6d().s[14]++;return validationResult;}else{cov_l7mg58j6d().b[1][1]++;}cov_l7mg58j6d().s[15]++;logger.info({config},`The customer data generation is started`);const stats=(cov_l7mg58j6d().s[16]++,{created:0});const{amount}=(cov_l7mg58j6d().s[17]++,config);cov_l7mg58j6d().s[18]++;progressLog.setTotal(amount);let lastCustomerKey=(cov_l7mg58j6d().s[19]++,await fetchLastCustomerKey());let batch=(cov_l7mg58j6d().s[20]++,[]);cov_l7mg58j6d().s[21]++;for(let counter=(cov_l7mg58j6d().s[22]++,1);counter<amount;counter++){const suffix=(cov_l7mg58j6d().s[23]++,`${randomWord()}_${counter}`);cov_l7mg58j6d().s[24]++;batch.push({suffix,customerKey:++lastCustomerKey});cov_l7mg58j6d().s[25]++;if(batch.length===batchSize){cov_l7mg58j6d().b[2][0]++;cov_l7mg58j6d().s[26]++;await executeBatch(batch,stats);cov_l7mg58j6d().s[27]++;batch=[];}else{cov_l7mg58j6d().b[2][1]++;}}cov_l7mg58j6d().s[28]++;await executeBatch(batch,stats);cov_l7mg58j6d().s[29]++;await createLastCustomer(amount,++lastCustomerKey,stats);cov_l7mg58j6d().s[30]++;logger.info('The customer data generation is completed.');const endDate=(cov_l7mg58j6d().s[31]++,new Date());cov_l7mg58j6d().s[32]++;stats.executionTimeInSeconds=Math.floor(Math.abs(endDate-startDate)/1000);cov_l7mg58j6d().s[33]++;return stats;}async function executeBatch(batch,stats){cov_l7mg58j6d().f[2]++;cov_l7mg58j6d().s[34]++;await Promise.all(batch.map(async({suffix,customerKey})=>{cov_l7mg58j6d().f[3]++;cov_l7mg58j6d().s[35]++;await buildDraftAndCreateCustomer(suffix,customerKey);cov_l7mg58j6d().s[36]++;stats.created++;cov_l7mg58j6d().s[37]++;progressLog.increment();}));}const maxRetry=(cov_l7mg58j6d().s[38]++,5);async function buildDraftAndCreateCustomer(suffix,customerKey,retryCounter=(cov_l7mg58j6d().b[3][0]++,0)){cov_l7mg58j6d().f[4]++;cov_l7mg58j6d().s[39]++;try{const customerDraft=(cov_l7mg58j6d().s[40]++,buildCustomerDraft(suffix,customerKey));cov_l7mg58j6d().s[41]++;await apiRoot().customers().post({body:customerDraft}).execute();}catch(err){cov_l7mg58j6d().s[42]++;logger.error(err);cov_l7mg58j6d().s[43]++;if((cov_l7mg58j6d().b[5][0]++,retryCounter<maxRetry)&&((cov_l7mg58j6d().b[5][1]++,err.statusCode===400)||(cov_l7mg58j6d().b[5][2]++,err.statusCode===409)||(cov_l7mg58j6d().b[5][3]++,err.statusCode>=500))){cov_l7mg58j6d().b[4][0]++;cov_l7mg58j6d().s[44]++;await buildDraftAndCreateCustomer(suffix,customerKey,++retryCounter);cov_l7mg58j6d().s[45]++;return;}else{cov_l7mg58j6d().b[4][1]++;}cov_l7mg58j6d().s[46]++;throw err;}}async function createLastCustomer(amount,customerKey,stats){cov_l7mg58j6d().f[5]++;const suffix=(cov_l7mg58j6d().s[47]++,`${randomWord()}_${amount}`);cov_l7mg58j6d().s[48]++;await buildDraftAndCreateCustomer(suffix,customerKey);cov_l7mg58j6d().s[49]++;stats.created++;cov_l7mg58j6d().s[50]++;progressLog.increment();}async function fetchLastCustomerKey(){cov_l7mg58j6d().f[6]++;const queryArgs=(cov_l7mg58j6d().s[51]++,{limit:1,withTotal:false,where:'title="data-generation"',sort:'createdAt desc'});const{body:{results},statusCode}=(cov_l7mg58j6d().s[52]++,await apiRoot().customers().get({queryArgs}).execute());let lastCustomerKey=(cov_l7mg58j6d().s[53]++,0);cov_l7mg58j6d().s[54]++;if((cov_l7mg58j6d().b[7][0]++,statusCode===200)&&(cov_l7mg58j6d().b[7][1]++,results.length>0)){cov_l7mg58j6d().b[6][0]++;const{key}=(cov_l7mg58j6d().s[55]++,results[0]);cov_l7mg58j6d().s[56]++;lastCustomerKey=parseInt(key.replace('customer_',''),10);}else{cov_l7mg58j6d().b[6][1]++;}cov_l7mg58j6d().s[57]++;return lastCustomerKey;}cov_l7mg58j6d().s[58]++;module.exports={generateCustomers};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQcm9ncmVzc0xvZyIsInJlcXVpcmUiLCJmZXRjaEN1c3RvbWVyc0NvbmZpZyIsImFwaVJvb3QiLCJsb2dnZXIiLCJnZXRMb2dnZXIiLCJ2YWxpZGF0ZUNvbmZpZyIsImJ1aWxkQ3VzdG9tZXJEcmFmdCIsInJhbmRvbVdvcmQiLCJzY2hlbWEiLCJwcm9ncmVzc0xvZyIsInByb2dyZXNzIiwicHJvY2Vzc2VkIiwidG90YWwiLCJpbmZvIiwiZ2VuZXJhdGVDdXN0b21lcnMiLCJiYXRjaFNpemUiLCJzdGFydERhdGUiLCJEYXRlIiwiY29uZmlnIiwidmFsaWRhdGlvblJlc3VsdCIsInNraXAiLCJzdGF0cyIsImNyZWF0ZWQiLCJhbW91bnQiLCJzZXRUb3RhbCIsImxhc3RDdXN0b21lcktleSIsImZldGNoTGFzdEN1c3RvbWVyS2V5IiwiYmF0Y2giLCJjb3VudGVyIiwic3VmZml4IiwicHVzaCIsImN1c3RvbWVyS2V5IiwibGVuZ3RoIiwiZXhlY3V0ZUJhdGNoIiwiY3JlYXRlTGFzdEN1c3RvbWVyIiwiZW5kRGF0ZSIsImV4ZWN1dGlvblRpbWVJblNlY29uZHMiLCJNYXRoIiwiZmxvb3IiLCJhYnMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwiYnVpbGREcmFmdEFuZENyZWF0ZUN1c3RvbWVyIiwiaW5jcmVtZW50IiwibWF4UmV0cnkiLCJyZXRyeUNvdW50ZXIiLCJjdXN0b21lckRyYWZ0IiwiY3VzdG9tZXJzIiwicG9zdCIsImJvZHkiLCJleGVjdXRlIiwiZXJyIiwiZXJyb3IiLCJzdGF0dXNDb2RlIiwicXVlcnlBcmdzIiwibGltaXQiLCJ3aXRoVG90YWwiLCJ3aGVyZSIsInNvcnQiLCJyZXN1bHRzIiwiZ2V0Iiwia2V5IiwicGFyc2VJbnQiLCJyZXBsYWNlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImltcG9ydGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFByb2dyZXNzTG9nID0gcmVxdWlyZSgnLi4vcHJvZ3Jlc3MtbG9nJylcbmNvbnN0IHsgZmV0Y2hDdXN0b21lcnNDb25maWcgfSA9IHJlcXVpcmUoJy4uL2N1c3RvbS1vYmplY3QnKVxuY29uc3QgeyBhcGlSb290IH0gPSByZXF1aXJlKCcuLi9jbGllbnQnKVxuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnLi4vbG9nZ2VyJykuZ2V0TG9nZ2VyKClcbmNvbnN0IHsgdmFsaWRhdGVDb25maWcgfSA9IHJlcXVpcmUoJy4uL3ZhbGlkYXRvcicpXG5jb25zdCB7IGJ1aWxkQ3VzdG9tZXJEcmFmdCB9ID0gcmVxdWlyZSgnLi9kcmFmdC1idWlsZGVyJylcbmNvbnN0IHsgcmFuZG9tV29yZCB9ID0gcmVxdWlyZSgnLi4vcmFuZG9tJylcbmNvbnN0IHNjaGVtYSA9IHJlcXVpcmUoJy4vc2NoZW1hLmpzb24nKVxuXG5jb25zdCBwcm9ncmVzc0xvZyA9IG5ldyBQcm9ncmVzc0xvZygocHJvZ3Jlc3MsIHByb2Nlc3NlZCwgdG90YWwpID0+XG4gIGxvZ2dlci5pbmZvKFxuICAgIGBQcm9ncmVzcyBvbiBjdXN0b21lciBkYXRhIGdlbmVyYXRpb246ICR7cHJvZ3Jlc3N9JSAoJHtwcm9jZXNzZWR9LyR7dG90YWx9KS5gXG4gIClcbilcblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDdXN0b21lcnMoYmF0Y2hTaXplID0gMTAwKSB7XG4gIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKClcblxuICBjb25zdCBjb25maWcgPSBhd2FpdCBmZXRjaEN1c3RvbWVyc0NvbmZpZygpXG4gIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSB2YWxpZGF0ZUNvbmZpZyhzY2hlbWEsIGNvbmZpZylcbiAgaWYgKHZhbGlkYXRpb25SZXN1bHQuc2tpcCkgcmV0dXJuIHZhbGlkYXRpb25SZXN1bHRcblxuICBsb2dnZXIuaW5mbyh7IGNvbmZpZyB9LCBgVGhlIGN1c3RvbWVyIGRhdGEgZ2VuZXJhdGlvbiBpcyBzdGFydGVkYClcbiAgY29uc3Qgc3RhdHMgPSB7XG4gICAgY3JlYXRlZDogMCxcbiAgfVxuXG4gIGNvbnN0IHsgYW1vdW50IH0gPSBjb25maWdcbiAgcHJvZ3Jlc3NMb2cuc2V0VG90YWwoYW1vdW50KVxuXG4gIGxldCBsYXN0Q3VzdG9tZXJLZXkgPSBhd2FpdCBmZXRjaExhc3RDdXN0b21lcktleSgpXG4gIGxldCBiYXRjaCA9IFtdXG4gIGZvciAobGV0IGNvdW50ZXIgPSAxOyBjb3VudGVyIDwgYW1vdW50OyBjb3VudGVyKyspIHtcbiAgICBjb25zdCBzdWZmaXggPSBgJHtyYW5kb21Xb3JkKCl9XyR7Y291bnRlcn1gXG4gICAgYmF0Y2gucHVzaCh7IHN1ZmZpeCwgY3VzdG9tZXJLZXk6ICsrbGFzdEN1c3RvbWVyS2V5IH0pXG4gICAgaWYgKGJhdGNoLmxlbmd0aCA9PT0gYmF0Y2hTaXplKSB7XG4gICAgICBhd2FpdCBleGVjdXRlQmF0Y2goYmF0Y2gsIHN0YXRzKVxuICAgICAgYmF0Y2ggPSBbXVxuICAgIH1cbiAgfVxuICBhd2FpdCBleGVjdXRlQmF0Y2goYmF0Y2gsIHN0YXRzKVxuICBhd2FpdCBjcmVhdGVMYXN0Q3VzdG9tZXIoYW1vdW50LCArK2xhc3RDdXN0b21lcktleSwgc3RhdHMpXG5cbiAgbG9nZ2VyLmluZm8oJ1RoZSBjdXN0b21lciBkYXRhIGdlbmVyYXRpb24gaXMgY29tcGxldGVkLicpXG4gIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSgpXG4gIHN0YXRzLmV4ZWN1dGlvblRpbWVJblNlY29uZHMgPSBNYXRoLmZsb29yKFxuICAgIE1hdGguYWJzKGVuZERhdGUgLSBzdGFydERhdGUpIC8gMTAwMFxuICApXG5cbiAgcmV0dXJuIHN0YXRzXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVCYXRjaChiYXRjaCwgc3RhdHMpIHtcbiAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgYmF0Y2gubWFwKGFzeW5jICh7IHN1ZmZpeCwgY3VzdG9tZXJLZXkgfSkgPT4ge1xuICAgICAgYXdhaXQgYnVpbGREcmFmdEFuZENyZWF0ZUN1c3RvbWVyKHN1ZmZpeCwgY3VzdG9tZXJLZXkpXG4gICAgICBzdGF0cy5jcmVhdGVkKytcbiAgICAgIHByb2dyZXNzTG9nLmluY3JlbWVudCgpXG4gICAgfSlcbiAgKVxufVxuXG5jb25zdCBtYXhSZXRyeSA9IDVcbmFzeW5jIGZ1bmN0aW9uIGJ1aWxkRHJhZnRBbmRDcmVhdGVDdXN0b21lcihcbiAgc3VmZml4LFxuICBjdXN0b21lcktleSxcbiAgcmV0cnlDb3VudGVyID0gMFxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgY3VzdG9tZXJEcmFmdCA9IGJ1aWxkQ3VzdG9tZXJEcmFmdChzdWZmaXgsIGN1c3RvbWVyS2V5KVxuICAgIGF3YWl0IGFwaVJvb3QoKS5jdXN0b21lcnMoKS5wb3N0KHsgYm9keTogY3VzdG9tZXJEcmFmdCB9KS5leGVjdXRlKClcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nZ2VyLmVycm9yKGVycilcbiAgICBpZiAoXG4gICAgICByZXRyeUNvdW50ZXIgPCBtYXhSZXRyeSAmJlxuICAgICAgKGVyci5zdGF0dXNDb2RlID09PSA0MDAgfHxcbiAgICAgICAgZXJyLnN0YXR1c0NvZGUgPT09IDQwOSB8fFxuICAgICAgICBlcnIuc3RhdHVzQ29kZSA+PSA1MDApXG4gICAgKSB7XG4gICAgICBhd2FpdCBidWlsZERyYWZ0QW5kQ3JlYXRlQ3VzdG9tZXIoc3VmZml4LCBjdXN0b21lcktleSwgKytyZXRyeUNvdW50ZXIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aHJvdyBlcnJcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVMYXN0Q3VzdG9tZXIoYW1vdW50LCBjdXN0b21lcktleSwgc3RhdHMpIHtcbiAgY29uc3Qgc3VmZml4ID0gYCR7cmFuZG9tV29yZCgpfV8ke2Ftb3VudH1gXG4gIGF3YWl0IGJ1aWxkRHJhZnRBbmRDcmVhdGVDdXN0b21lcihzdWZmaXgsIGN1c3RvbWVyS2V5KVxuICBzdGF0cy5jcmVhdGVkKytcbiAgcHJvZ3Jlc3NMb2cuaW5jcmVtZW50KClcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hMYXN0Q3VzdG9tZXJLZXkoKSB7XG4gIGNvbnN0IHF1ZXJ5QXJncyA9IHtcbiAgICBsaW1pdDogMSxcbiAgICB3aXRoVG90YWw6IGZhbHNlLFxuICAgIHdoZXJlOiAndGl0bGU9XCJkYXRhLWdlbmVyYXRpb25cIicsXG4gICAgc29ydDogJ2NyZWF0ZWRBdCBkZXNjJyxcbiAgfVxuICBjb25zdCB7XG4gICAgYm9keTogeyByZXN1bHRzIH0sXG4gICAgc3RhdHVzQ29kZSxcbiAgfSA9IGF3YWl0IGFwaVJvb3QoKS5jdXN0b21lcnMoKS5nZXQoeyBxdWVyeUFyZ3MgfSkuZXhlY3V0ZSgpXG5cbiAgbGV0IGxhc3RDdXN0b21lcktleSA9IDBcbiAgaWYgKHN0YXR1c0NvZGUgPT09IDIwMCAmJiByZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB7IGtleSB9ID0gcmVzdWx0c1swXVxuICAgIGxhc3RDdXN0b21lcktleSA9IHBhcnNlSW50KGtleS5yZXBsYWNlKCdjdXN0b21lcl8nLCAnJyksIDEwKVxuICB9XG4gIHJldHVybiBsYXN0Q3VzdG9tZXJLZXlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdlbmVyYXRlQ3VzdG9tZXJzLFxufVxuIl0sIm1hcHBpbmdzIjoidS9OQWVZO3lGQWZaLEtBQU1BLFlBQVcseUJBQUdDLE9BQU8sQ0FBQyxpQkFBRCxDQUFWLENBQWpCLENBQ0EsS0FBTSxDQUFFQyxvQkFBRiwwQkFBMkJELE9BQU8sQ0FBQyxrQkFBRCxDQUFsQyxDQUFOLENBQ0EsS0FBTSxDQUFFRSxPQUFGLDBCQUFjRixPQUFPLENBQUMsV0FBRCxDQUFyQixDQUFOLENBQ0EsS0FBTUcsT0FBTSx5QkFBR0gsT0FBTyxDQUFDLFdBQUQsQ0FBUCxDQUFxQkksU0FBckIsRUFBSCxDQUFaLENBQ0EsS0FBTSxDQUFFQyxjQUFGLDBCQUFxQkwsT0FBTyxDQUFDLGNBQUQsQ0FBNUIsQ0FBTixDQUNBLEtBQU0sQ0FBRU0sa0JBQUYsMEJBQXlCTixPQUFPLENBQUMsaUJBQUQsQ0FBaEMsQ0FBTixDQUNBLEtBQU0sQ0FBRU8sVUFB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